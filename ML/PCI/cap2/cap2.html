<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>提供推荐 | 机器学习</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.1.0">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="../../PCI/cap3/cap3.html" />
    
    
    <link rel="prev" href="../../PCI/readme.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../../gitbook/style.css">


        
    <div class="book" data-level="1.1" data-basepath="../.." data-revision="1428042646490">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="PCI/readme.html">
            
                
                    <a href="../../PCI/readme.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         集体智慧编程
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter active" data-level="1.1" data-path="PCI/cap2/cap2.html">
            
                
                    <a href="../../PCI/cap2/cap2.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                         提供推荐
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="PCI/cap3/cap3.html">
            
                
                    <a href="../../PCI/cap3/cap3.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                         发现群组
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.3" data-path="PCI/cap4/cap4.html">
            
                
                    <a href="../../PCI/cap4/cap4.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                         搜索与排名
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.4" data-path="PCI/cap5/cap5.html">
            
                
                    <a href="../../PCI/cap5/cap5.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                         优化
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.5" data-path="PCI/cap6/cap6.html">
            
                
                    <a href="../../PCI/cap6/cap6.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                         文档过滤
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.6" data-path="PCI/cap7/cap7.html">
            
                
                    <a href="../../PCI/cap7/cap7.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.6.</b>
                        
                         决策树建模
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.7" data-path="PCI/cap8/cap8.html">
            
                
                    <a href="../../PCI/cap8/cap8.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.7.</b>
                        
                         构建价格模型
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.8" data-path="PCI/cap9/cap9.html">
            
                
                    <a href="../../PCI/cap9/cap9.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.</b>
                        
                         高阶分类：核心方法和SVMs
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.9" data-path="PCI/cap10/cap10.html">
            
                
                    <a href="../../PCI/cap10/cap10.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.9.</b>
                        
                         寻找独立特征
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.10" data-path="PCI/cap11/cap11.html">
            
                
                    <a href="../../PCI/cap11/cap11.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.10.</b>
                        
                         智能进化
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1.11" data-path="PCI/cap12/cap12.html">
            
                
                    <a href="../../PCI/cap12/cap12.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.11.</b>
                        
                         算法总结
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >机器学习</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_5">
                    
                        <h2 id="2-">第2章 提供推荐</h2>
<p>making recommandations</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt

<span class="hljs-comment"># 协作型过滤 (collaborative filtering)</span>

<span class="hljs-comment">## 搜集偏好</span>
critics = {
    <span class="hljs-string">'Lisa Rose'</span>: {
        <span class="hljs-string">'Lady in the Water'</span>: <span class="hljs-number">2.5</span>, 
        <span class="hljs-string">'Snakes on a Plane'</span>: <span class="hljs-number">3.5</span>,
        <span class="hljs-string">'Just My Luck'</span>: <span class="hljs-number">3.0</span>, 
        <span class="hljs-string">'Superman Returns'</span>: <span class="hljs-number">3.5</span>, 
        <span class="hljs-string">'You, Me and Dupree'</span>: <span class="hljs-number">2.5</span>,
        <span class="hljs-string">'The Night Listener'</span>: <span class="hljs-number">3.0</span>,
    },
    <span class="hljs-string">'Gene Seymour'</span>: {
        <span class="hljs-string">'Lady in the Water'</span>: <span class="hljs-number">3.0</span>, 
        <span class="hljs-string">'Snakes on a Plane'</span>: <span class="hljs-number">3.5</span>,
        <span class="hljs-string">'Just My Luck'</span>: <span class="hljs-number">1.5</span>, 
        <span class="hljs-string">'Superman Returns'</span>: <span class="hljs-number">5.0</span>, 
        <span class="hljs-string">'You, Me and Dupree'</span>: <span class="hljs-number">3.0</span>,
        <span class="hljs-string">'The Night Listener'</span>: <span class="hljs-number">3.5</span>
    },
    <span class="hljs-string">'Michael Phillips'</span>: {
        <span class="hljs-string">'Lady in the Water'</span>: <span class="hljs-number">2.5</span>, 
        <span class="hljs-string">'Snakes on a Plane'</span>: <span class="hljs-number">3.0</span>,
        <span class="hljs-comment">#'Just My Luck': 1.5, </span>
        <span class="hljs-string">'Superman Returns'</span>: <span class="hljs-number">3.5</span>, 
        <span class="hljs-comment">#'You, Me and Dupree': 3.0,</span>
        <span class="hljs-string">'The Night Listener'</span>: <span class="hljs-number">4.0</span>,
    },
    <span class="hljs-string">'Claudia Puig'</span>: {
        <span class="hljs-string">'Lady in the Water'</span>: <span class="hljs-number">4.5</span>, 
        <span class="hljs-string">'Snakes on a Plane'</span>: <span class="hljs-number">3.5</span>,
        <span class="hljs-string">'Just My Luck'</span>: <span class="hljs-number">3.0</span>, 
        <span class="hljs-string">'Superman Returns'</span>: <span class="hljs-number">4.0</span>, 
        <span class="hljs-string">'You, Me and Dupree'</span>: <span class="hljs-number">2.5</span>,
        <span class="hljs-string">'The Night Listener'</span>: <span class="hljs-number">4.5</span>,
    },
    <span class="hljs-string">'Mick LaSalle'</span>: {
        <span class="hljs-string">'Lady in the Water'</span>: <span class="hljs-number">3.0</span>, 
        <span class="hljs-string">'Snakes on a Plane'</span>: <span class="hljs-number">4.0</span>,
        <span class="hljs-string">'Just My Luck'</span>: <span class="hljs-number">2.0</span>, 
        <span class="hljs-string">'Superman Returns'</span>: <span class="hljs-number">3.0</span>, 
        <span class="hljs-string">'You, Me and Dupree'</span>: <span class="hljs-number">2.0</span>,
        <span class="hljs-string">'The Night Listener'</span>: <span class="hljs-number">3.0</span>,
    },
    <span class="hljs-string">'Jack Matthews'</span>: {
        <span class="hljs-string">'Lady in the Water'</span>: <span class="hljs-number">3.0</span>, 
        <span class="hljs-string">'Snakes on a Plane'</span>: <span class="hljs-number">4.0</span>,
        <span class="hljs-comment">#'Just My Luck': 1.5, </span>
        <span class="hljs-string">'Superman Returns'</span>: <span class="hljs-number">5.0</span>, 
        <span class="hljs-string">'You, Me and Dupree'</span>: <span class="hljs-number">3.5</span>,
        <span class="hljs-string">'The Night Listener'</span>: <span class="hljs-number">3.0</span>,
    },
    <span class="hljs-string">'Toby'</span>: {
        <span class="hljs-comment">#'Lady in the Water': 3.0, </span>
        <span class="hljs-string">'Snakes on a Plane'</span>: <span class="hljs-number">4.5</span>,
        <span class="hljs-comment">#'Just My Luck': 1.5, </span>
        <span class="hljs-string">'Superman Returns'</span>: <span class="hljs-number">4.0</span>, 
        <span class="hljs-string">'You, Me and Dupree'</span>: <span class="hljs-number">1.0</span>,
        <span class="hljs-comment">#'The Night Listener': 3.5</span>
    },
}

<span class="hljs-comment">## 寻找相近的用户 finding similar users</span>

<span class="hljs-comment"># 用于比较的度量算法</span>
<span class="hljs-comment"># http://en.wikipedia.org/wiki/Metric_%28mathematics%29#Examples</span>

<span class="hljs-comment">### 欧几里德距离评价 euclidean distance score</span>

<span class="hljs-comment"># returns a distance-based similarity score for person1 and person2</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sim_distance</span><span class="hljs-params">(prefs, person1, person2)</span>:</span>
    <span class="hljs-string">'''
    1/(1+sum((p1.a-p2.a)**2 ...))
    '''</span>
    <span class="hljs-comment"># get the list of shared_items</span>
    si = {}
    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> prefs[person1]:
        <span class="hljs-keyword">if</span> item <span class="hljs-keyword">in</span> prefs[person2]:
            si[item] = <span class="hljs-number">1</span>

    <span class="hljs-comment"># if they have no ratings in common, return 0</span>
    <span class="hljs-keyword">if</span> (len) == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
    <span class="hljs-comment"># add up the squares of all the differences</span>
    sum_of_squares = sum([pow(prefs[person1][item]-prefs[person2][item], <span class="hljs-number">2</span>)
            <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> prefs[person1] <span class="hljs-keyword">if</span> item <span class="hljs-keyword">in</span> prefs[person2]])

    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>/(<span class="hljs-number">1</span>+sqrt(sum_of_squares))

<span class="hljs-comment">### 皮尔逊相关度评价 pearson correlation score</span>

<span class="hljs-comment"># returns the pearson correlation coefficient for p1 and p2</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sim_pearson</span><span class="hljs-params">(prefs, p1, p2)</span>:</span>
    <span class="hljs-string">''' sum(p1.a * p2.a, ...) - sum(p1.a, ...)*sum(p2.a, ...)/n
        _______________________________________________________
        ____________________________________________________________________________
       V (sum(p1.a**2, ...)-sum(p1.a, ...)**2/n) * (sum(p2.a**2, ...)-sum(p2.a, ...)**2/n)
    '''</span>
    <span class="hljs-comment"># get the list of mutually reated items</span>
    si = {item:<span class="hljs-number">1</span> <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> prefs[p1] <span class="hljs-keyword">if</span> item <span class="hljs-keyword">in</span> prefs[p2]}

    <span class="hljs-comment"># find the number of elements </span>
    n = len(si)

    <span class="hljs-comment"># if they are no ratings in common, return 0</span>
    <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

    <span class="hljs-comment"># add up all the preferences</span>
    sum1 = sum([prefs[p1][it] <span class="hljs-keyword">for</span> it <span class="hljs-keyword">in</span> si])
    sum2 = sum([prefs[p2][it] <span class="hljs-keyword">for</span> it <span class="hljs-keyword">in</span> si])

    <span class="hljs-comment"># sum up the squares</span>
    sum1Sq = sum([pow(prefs[p1][it], <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> it <span class="hljs-keyword">in</span> si])
    sum2Sq = sum([pow(prefs[p2][it], <span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> it <span class="hljs-keyword">in</span> si])

    <span class="hljs-comment"># sum up the products</span>
    pSum = sum([prefs[p1][it]*prefs[p2][it] <span class="hljs-keyword">for</span> it <span class="hljs-keyword">in</span> si])

    <span class="hljs-comment"># calculate pearson score</span>
    num = pSum - (sum1 * sum2 / n)
    den = sqrt((sum1Sq - pow(sum1, <span class="hljs-number">2</span>)/n) * (sum2Sq - pow(sum2, <span class="hljs-number">2</span>)/n))
    <span class="hljs-keyword">if</span> den == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>

    <span class="hljs-keyword">return</span> num/den

<span class="hljs-comment">### 为评论者打分 ranking the critics</span>

<span class="hljs-comment"># returns the best matches for person from the prefs dictionary.</span>
<span class="hljs-comment"># number of results and similarity function are optional params.</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">topMatches</span><span class="hljs-params">(prefs, person, n=<span class="hljs-number">5</span>, similarity=sim_pearson)</span>:</span>
    scores = [(similarity(prefs, person, other), other)
            <span class="hljs-keyword">for</span> other <span class="hljs-keyword">in</span> prefs <span class="hljs-keyword">if</span> other != person]

    <span class="hljs-comment"># sort the list so the highest scores appear at the top</span>
    scores.sort(reverse=<span class="hljs-keyword">True</span>)
    <span class="hljs-keyword">return</span> scores[<span class="hljs-number">0</span>:n]


<span class="hljs-comment">## 推荐物品 recommending items</span>

<span class="hljs-comment"># gets recommendations for a person by using a weighted average</span>
<span class="hljs-comment"># of every other user's rankings</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getRecommendations</span><span class="hljs-params">(prefs, person, similarity=sim_pearson)</span>:</span>
    <span class="hljs-string">'''user-based '''</span>
    totals = {}
    simSums = {}
    <span class="hljs-keyword">for</span> other <span class="hljs-keyword">in</span> prefs:
        <span class="hljs-comment"># don't compare me to myself</span>
        <span class="hljs-keyword">if</span> other == person: <span class="hljs-keyword">continue</span>
        sim = similarity(prefs, person, other)

        <span class="hljs-comment"># ignore scores of zero or lower</span>
        <span class="hljs-keyword">if</span> sim &lt;= <span class="hljs-number">0</span>: <span class="hljs-keyword">continue</span>
        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> prefs[other]:
            <span class="hljs-comment"># only score movies I haven't seen yet</span>
            <span class="hljs-keyword">if</span> item <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> prefs[person] <span class="hljs-keyword">or</span> prefs[person][item] == <span class="hljs-number">0</span>:
                <span class="hljs-comment"># similarity * score</span>
                totals.setdefault(item, <span class="hljs-number">0</span>)
                totals[item] += prefs[other][item]*sim
                <span class="hljs-comment"># sum of similarities</span>
                simSums.setdefault(item, <span class="hljs-number">0</span>)
                simSums[item] += sim

    <span class="hljs-comment"># create the normalized list</span>
    rankings = [(total/simSums[item], item) <span class="hljs-keyword">for</span> item, total <span class="hljs-keyword">in</span> totals.items()]

    <span class="hljs-comment"># return the sorted list</span>
    rankings.sort(reverse=<span class="hljs-keyword">True</span>)
    <span class="hljs-keyword">return</span> rankings


<span class="hljs-comment">## 匹配商品 matching products -- 了解哪些商品是彼此相近的</span>

<span class="hljs-comment"># 各个人对某一商品评分的集合</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">transformPrefs</span><span class="hljs-params">(prefs)</span>:</span>
    result = {}
    <span class="hljs-keyword">for</span> person <span class="hljs-keyword">in</span> prefs:
        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> prefs[person]:
            result.setdefault(item, {})

            <span class="hljs-comment"># flip item and person</span>
            result[item][person] = prefs[person][item]
    <span class="hljs-keyword">return</span> result


<span class="hljs-comment">## 构建一个基于del.icio.us的链接推荐系统 -- building a del.icio.us link recommender</span>

<span class="hljs-comment">### the del.icio.us API</span>

<span class="hljs-comment">### building the dataset</span>

<span class="hljs-comment">### recommanding neighbors and links</span>

<span class="hljs-comment">## 基于物品的过滤 -- Item-Based Filtering</span>

s = <span class="hljs-string">'''
总体思路：为每件物品预先计算好最为相近的其他物品。
然后，当我们想为某位用户提供推荐时，就可以查看他曾经评过分的物品，
并从中选出排位靠前者，在构造出一个加权列表，
其中包含了与这些选中物品最为相近的其他物品
'''</span>

<span class="hljs-comment">### building the item comparison dataset</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">calculateSimilarItems</span><span class="hljs-params">(prefs, n=<span class="hljs-number">10</span>)</span>:</span>
    <span class="hljs-comment"># create a dictionary of items showing which other items they</span>
    <span class="hljs-comment"># are most similar to.</span>
    result = {}

    <span class="hljs-comment"># invert the preference matrix to be item-centric</span>
    itemPrefs = transformPrefs(prefs)
    c = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> itemPrefs:
        <span class="hljs-comment"># status updates for large datasets</span>
        c += <span class="hljs-number">1</span>
        <span class="hljs-keyword">if</span> c%<span class="hljs-number">100</span> == <span class="hljs-number">0</span>: <span class="hljs-keyword">print</span> <span class="hljs-string">'%d / %d'</span> % (c, len(itemPrefs))
        <span class="hljs-comment"># find the most similar items to this one</span>
        scores = topMatches(itemPrefs, item, n=n, similarity=sim_distance)
        result[item] = scores
    <span class="hljs-keyword">return</span> result

<span class="hljs-comment">### 获得推荐-- getting recommendations</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getRecommendedItems</span><span class="hljs-params">(prefs, itemMatch, user)</span>:</span>
    <span class="hljs-string">'''Item-based'''</span>
    userRatings = prefs[user]
    scores = {}
    totalSim = {}

    <span class="hljs-comment"># loop over items rated by this user</span>
    <span class="hljs-keyword">for</span> (item, rating) <span class="hljs-keyword">in</span> userRatings.items():
        <span class="hljs-comment"># loop over items similar to this one</span>
        <span class="hljs-keyword">for</span> (similarity, item2) <span class="hljs-keyword">in</span> itemMatch[item]:

            <span class="hljs-comment"># ignore if this user has already rated this item</span>
            <span class="hljs-keyword">if</span> item2 <span class="hljs-keyword">in</span> userRatings: <span class="hljs-keyword">continue</span>

            <span class="hljs-comment"># weighted sum of rating times similarity</span>
            scores.setdefault(item2, <span class="hljs-number">0</span>)
            scores[item2] += similarity * rating

            <span class="hljs-comment"># sum of all the similarities</span>
            totalSim.setdefault(item2, <span class="hljs-number">0</span>)
            totalSim[item2] += similarity

    <span class="hljs-comment"># divide each total score by total weighting to get an average</span>
    rankings = [(score/totalSim[item], item) <span class="hljs-keyword">for</span> (item, score) <span class="hljs-keyword">in</span> scores.items()]

    <span class="hljs-comment"># return the ranking from highest to lowest</span>
    rankings.sort(reverse=<span class="hljs-keyword">True</span>)
    <span class="hljs-keyword">return</span> rankings
</code></pre>
<h2 id="movielens----using-the-movielens-dataset">使用MovieLens数据集 -- using the MovieLens dataset</h2>
<h2 id="----user-based-or-item-based-filtering">基于用户进行过滤还是基于物品进行过滤 -- User-Based or Item-Based Filtering?</h2>
<h2 id="exercises">Exercises</h2>
<h3 id="1-tanimote-score">1. tanimote score</h3>
<h1 id="a--1234">A = [1,2,3,4]</h1>
<h1 id="b--125">B = [1,2,5]</h1>
<h1 id="c--a-n-b--12">C = A n B = [1,2]</h1>
<h1 id="t--nc--na--nb---nc--243-204">T = Nc / (Na + Nb - Nc) = 2/(4+3-2)=0.4</h1>
<h3 id="2-tag-similarity">2. tag similarity</h3>
<h3 id="3-user-based-efficiency">3. User-based efficiency</h3>
<h3 id="4-item-based-bookmark-filtering">4. Item-based bookmark filtering</h3>
<h3 id="5-audioscrobbler">5. audioscrobbler</h3>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../PCI/readme.html" class="navigation navigation-prev " aria-label="Previous page: 集体智慧编程"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../PCI/cap3/cap3.html" class="navigation navigation-next " aria-label="Next page: 发现群组"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
